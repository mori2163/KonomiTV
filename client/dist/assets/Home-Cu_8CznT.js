import{B}from"./Breadcrumbs-B2tokdSR.js";import{H as I,N as y}from"./Navigation-C0rLQn-z.js";import{R as M}from"./ReservationList-apXt6jjQ.js";import{S as A}from"./SPHeaderBar-cI681nm2.js";import{R as S}from"./Reservations-Cay184qH.js";import{d as U,A as l,J as E,al as H,c as L,a as n,b as p,n as N,ar as c,o as O,_ as P}from"./index-fVX7BD25.js";import"./ssrBoot-ohZdLY2y.js";import"./VSwitch-Nn_6Ef70.js";import"./index-CHS0X51H.js";import"./VTextField-CRh-5ELm.js";import"./transition-CY4bAqSy.js";import"./forwardRefs-B931MWyl.js";import"./VSelectionControl-BawWihcL.js";import"./VChip-CP2A-6fY.js";import"./VAvatar-CIAO3t6X.js";import"./VSlider-G0aJWNjf.js";import"./VSelect-COdEDpfY.js";import"./dialog-transition-D7rV2QZv.js";import"./VOverlay-C_1EwOrZ.js";import"./VDivider-JsVF-yo8.js";import"./VDialog-Bh551h6k.js";import"./VCard-C72PqayN.js";import"./VPagination-D5d2GC-D.js";const b={class:"route-container"},F={class:"reservations-home-container-wrapper"},T={class:"reservations-home-container"},C=30*1e3,D=10,V=U({__name:"Home",setup($){const m=l([]),u=l(0),s=l(!0),r=l(null),d={upcomingReservations:async()=>{const e=await S.fetchReservations();if(e){const a=c(),v=e.reservations.filter(t=>{const o=c(t.program.start_time),R=o.isAfter(a)&&o.isBefore(a.add(24,"hours")),w=t.is_recording_in_progress;return R||w}).sort((t,o)=>t.is_recording_in_progress&&!o.is_recording_in_progress?-1:!t.is_recording_in_progress&&o.is_recording_in_progress?1:c(t.program.start_time).valueOf()-c(o.program.start_time).valueOf());u.value=v.length,m.value=v.slice(0,D)}}},i=async()=>{try{await Promise.all(Object.values(d).map(e=>e())),s.value=!1}catch(e){console.error("Failed to update reservation sections:",e),s.value=!1}},_=e=>{console.log(`Reservation ${e} deleted, refreshing list...`),i()},g=()=>{r.value===null&&(i(),r.value=window.setInterval(i,C))},f=()=>{r.value!==null&&(clearInterval(r.value),r.value=null)};return E(()=>{g()}),H(()=>{f()}),(e,a)=>(O(),L("div",b,[n(I),p("main",null,[n(y),p("div",F,[n(A),p("div",T,[n(B,{crumbs:[{name:"ホーム",path:"/"},{name:"録画予約",path:"/reservations/",disabled:!0}]}),n(M,{class:N(["reservations-home-container__upcoming-reservations",{"reservations-home-container__upcoming-reservations--loading":m.value.length===0&&s.value}]),title:"放送が近い録画予約",reservations:m.value,total:u.value,hideSort:!0,hidePagination:!0,showMoreButton:!0,isLoading:s.value,showEmptyMessage:!s.value,emptyIcon:"fluent:timer-20-regular",emptyMessage:"まだ録画予約がありません。",emptySubMessage:"番組表から録画予約を追加できます。",showRefreshButton:!0,onRefresh:i,onMore:a[0]||(a[0]=h=>e.$router.push("/reservations/all")),onDelete:_},null,8,["class","reservations","total","isLoading","showEmptyMessage"])])])])]))}}),pe=P(V,[["__scopeId","data-v-3d9cd741"]]);export{pe as default};
