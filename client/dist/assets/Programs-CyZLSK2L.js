import{d as E,u as q,Z as r,B as P,z as S,an as k,ah as C,c as I,a as t,b as c,am as R,ao as b,M as p,o as L,_ as M}from"./index-DsB6ypse.js";import{B as V}from"./Breadcrumbs-Cm-OZASP.js";import{H as N,N as O}from"./Navigation-BOp283wj.js";import{S as x}from"./SPHeaderBar-C0Rk3uzR.js";import{R as H}from"./RecordedProgramList-8i4bP0RR.js";import{V as U}from"./Videos-BLwFv_ZS.js";import"./ssrBoot-BvndLrcu.js";import"./VDialog-Dsy2KfsX.js";import"./VOverlay-Brh1XGOs.js";import"./forwardRefs-B931MWyl.js";import"./dialog-transition-CRWuKpHL.js";import"./VCard-B9eVNnSx.js";import"./VRow-D8tNuKuV.js";import"./VSelect-BjCImy0U.js";import"./VTextField-DVPHArGs.js";import"./VDivider-CaRre93T.js";import"./VSelectionControl-JMdNnphM.js";import"./VPagination-BrFhG28F.js";import"./VTooltip-QvwL3_6i.js";const F={class:"route-container"},T={class:"recorded-programs-container-wrapper"},z={class:"recorded-programs-container"},Z=E({__name:"Programs",setup($){const a=k(),l=b();q();const u=r([]),m=r(0),s=r(!0),o=r(1),n=r("desc"),v=r(),d=async()=>{const e=await U.fetchVideos(n.value,o.value);e&&(u.value=e.recorded_programs,m.value=e.total),s.value=!1},f=async e=>{o.value=e,s.value=!0,await l.replace({query:{...a.query,page:e.toString()}})},_=async e=>{n.value=e,o.value=1,s.value=!0,await l.replace({query:{...a.query,order:e,page:"1"}})};P(()=>a.query,async e=>{e.page&&(o.value=parseInt(e.page)),e.order&&(n.value=e.order),await d()},{deep:!0});const g=()=>{d()};S(async()=>{a.query.page&&(o.value=parseInt(a.query.page)),a.query.order&&(n.value=a.query.order),await d(),window.addEventListener("tsreplace-encoding-completed",g)}),C(()=>{window.removeEventListener("tsreplace-encoding-completed",g)});const h=e=>{p.success("エンコードが完了しました。録画一覧を更新します。"),d()},y=(e,i)=>{p.error(`エンコードが失敗しました: ${i}`)},w=e=>{p.info("エンコードがキャンセルされました。")};return(e,i)=>(L(),I("div",F,[t(N),c("main",null,[t(O),c("div",T,[t(x),c("div",z,[t(V,{crumbs:[{name:"ホーム",path:"/"},{name:"ビデオをみる",path:"/videos/"},{name:"録画番組一覧",path:"/videos/programs",disabled:!0}]}),t(H,{title:"録画番組一覧",programs:u.value,total:m.value,page:o.value,sortOrder:n.value,isLoading:s.value,showBackButton:!0,showEmptyMessage:!s.value,"onUpdate:page":f,"onUpdate:sortOrder":i[0]||(i[0]=B=>_(B))},null,8,["programs","total","page","sortOrder","isLoading","showEmptyMessage"])])])]),t(R,{ref_key:"encodingProgress",ref:v,onCompleted:h,onFailed:y,onCancelled:w},null,512)]))}}),ce=M(Z,[["__scopeId","data-v-882bfd29"]]);export{ce as default};
