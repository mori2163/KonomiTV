import{d as ie,k as z,h as u,a as i,b as e,w as S,r as te,c as m,e as V,t as g,A as I,U,P as X,L as ce,F as Y,o as n,R as O,_ as se,q as D,u as _e,E as R,n as j,l as M,f as fe,p as F,j as ye,O as E,V as H,M as C,a3 as he,aa as be,C as we,D as ke,S as $e,ae as Me,af as Ve,ag as Le,ah as Pe,ai as Be,aj as le,ak as Ce,al as Q,am as T,N as Ie,an as Se,ao as xe,H as Re,ap as He,aq as ze,ar as Ae,as as Te,I as De,at as Fe,W as Z,au as de,a1 as ne,s as ee,g as Ne,B as We}from"./index-BpLevayy.js";import{V as ue}from"./VDialog-Babl3Qa3.js";import{a as ve,V as me,b as Ue,c as Ee}from"./VCard-CRJDcU4D.js";import{V as ge}from"./ssrBoot-BFtXHDOB.js";import{V as oe}from"./Videos-BeBax5ph.js";import{b as Oe,V as N,a as W,c as je,d as Ye}from"./VSelect-BmV3Cvca.js";import{b as qe}from"./VTextField-BLTdaO59.js";const Ke={class:"px-5 pb-6"},Ge={class:"text-subtitle-1 d-flex align-center font-weight-bold mt-2"},Xe={class:"video-info__item"},Je={class:"video-info__item-value"},Qe={class:"video-info__item"},Ze={class:"video-info__item-value"},et={class:"video-info__item"},tt={class:"video-info__item-value"},at={class:"video-info__item"},ot={class:"video-info__item-value"},it={class:"text-subtitle-1 d-flex align-center font-weight-bold mt-3"},st={class:"video-info__item"},rt={class:"video-info__item-value"},lt={class:"video-info__item"},dt={class:"video-info__item-value"},nt={class:"video-info__item"},ut={class:"video-info__item-value"},vt={class:"video-info__item"},mt={class:"video-info__item-value"},gt={class:"text-subtitle-1 d-flex align-center font-weight-bold mt-3"},pt={class:"video-info__item"},ct={class:"video-info__item-value"},_t={class:"video-info__item"},ft={class:"video-info__item-value"},yt={class:"video-info__item"},ht={class:"video-info__item-value"},bt={key:0,class:"text-subtitle-1 d-flex align-center font-weight-bold mt-3"},wt={class:"video-info__item"},kt={class:"video-info__item-value"},$t={class:"video-info__item"},Mt={class:"video-info__item-value"},Vt={class:"video-info__item"},Lt={class:"video-info__item-value"},Pt=ie({__name:"RecordedFileInfoDialog",props:{program:{},show:{type:Boolean}},emits:["update:show"],setup(o){return(l,t)=>{const b=te("Icon");return n(),z(ue,{"max-width":"770",transition:"slide-y-transition","model-value":l.show,"onUpdate:modelValue":t[1]||(t[1]=v=>l.$emit("update:show",v))},{default:u(()=>[i(ve,{class:"video-info"},{default:u(()=>[i(me,{class:"px-5 pt-6 pb-3 d-flex align-center font-weight-bold",style:{height:"60px"}},{default:u(()=>[i(b,{icon:"fluent:document-20-filled",height:"26px"}),t[2]||(t[2]=e("span",{class:"ml-3"},"録画ファイル情報",-1)),i(ge),S((n(),m("div",{class:"d-flex align-center rounded-circle cursor-pointer px-2 py-2",onClick:t[0]||(t[0]=v=>l.$emit("update:show",!1))},[i(b,{icon:"fluent:dismiss-12-filled",width:"23px",height:"23px"})])),[[O]])]),_:1}),e("div",Ke,[e("div",Ge,[i(b,{icon:"fluent:video-clip-20-filled",width:"24px",height:"20px"}),t[3]||(t[3]=e("span",{class:"ml-2"},"ファイル情報",-1))]),e("div",Xe,[t[4]||(t[4]=e("div",{class:"video-info__item-label"},"ファイルパス",-1)),e("div",Je,g(l.program.recorded_video.file_path),1)]),e("div",Qe,[t[5]||(t[5]=e("div",{class:"video-info__item-label"},"ファイルサイズ",-1)),e("div",Ze,g(I(U).formatBytes(l.program.recorded_video.file_size)),1)]),e("div",et,[t[6]||(t[6]=e("div",{class:"video-info__item-label"},"録画期間",-1)),e("div",tt,g(I(X).getRecordingTime(l.program)),1)]),e("div",at,[t[7]||(t[7]=e("div",{class:"video-info__item-label"},"最終更新日時",-1)),e("div",ot,g(I(ce)(l.program.recorded_video.file_modified_at).format("YYYY/MM/DD (dd) HH:mm:ss")),1)]),e("div",it,[i(b,{icon:"fluent:video-20-filled",width:"24px",height:"20px"}),t[8]||(t[8]=e("span",{class:"ml-2"},"映像情報",-1))]),e("div",st,[t[9]||(t[9]=e("div",{class:"video-info__item-label"},"コーデック",-1)),e("div",rt,g(l.program.recorded_video.video_codec)+" ("+g(l.program.recorded_video.video_codec_profile)+")",1)]),e("div",lt,[t[10]||(t[10]=e("div",{class:"video-info__item-label"},"解像度",-1)),e("div",dt,g(l.program.recorded_video.video_resolution_width)+"×"+g(l.program.recorded_video.video_resolution_height),1)]),e("div",nt,[t[11]||(t[11]=e("div",{class:"video-info__item-label"},"フレームレート",-1)),e("div",ut,g(l.program.recorded_video.video_frame_rate)+" fps",1)]),e("div",vt,[t[12]||(t[12]=e("div",{class:"video-info__item-label"},"スキャン方式",-1)),e("div",mt,g(l.program.recorded_video.video_scan_type),1)]),e("div",gt,[i(b,{icon:"fluent:speaker-2-20-filled",width:"24px",height:"20px"}),t[13]||(t[13]=e("span",{class:"ml-2"},"音声情報（主音声）",-1))]),e("div",pt,[t[14]||(t[14]=e("div",{class:"video-info__item-label"},"コーデック",-1)),e("div",ct,g(l.program.recorded_video.primary_audio_codec),1)]),e("div",_t,[t[15]||(t[15]=e("div",{class:"video-info__item-label"},"チャンネル",-1)),e("div",ft,g(l.program.recorded_video.primary_audio_channel),1)]),e("div",yt,[t[16]||(t[16]=e("div",{class:"video-info__item-label"},"サンプリングレート",-1)),e("div",ht,g(l.program.recorded_video.primary_audio_sampling_rate?`${l.program.recorded_video.primary_audio_sampling_rate/1e3}kHz`:"不明"),1)]),l.program.recorded_video.secondary_audio_codec?(n(),m("div",bt,[i(b,{icon:"fluent:speaker-2-20-filled",width:"24px",height:"20px"}),t[17]||(t[17]=e("span",{class:"ml-2"},"音声情報（副音声）",-1))])):V("",!0),l.program.recorded_video.secondary_audio_codec?(n(),m(Y,{key:1},[e("div",wt,[t[18]||(t[18]=e("div",{class:"video-info__item-label"},"コーデック",-1)),e("div",kt,g(l.program.recorded_video.secondary_audio_codec),1)]),e("div",$t,[t[19]||(t[19]=e("div",{class:"video-info__item-label"},"チャンネル",-1)),e("div",Mt,g(l.program.recorded_video.secondary_audio_channel),1)]),e("div",Vt,[t[20]||(t[20]=e("div",{class:"video-info__item-label"},"サンプリングレート",-1)),e("div",Lt,g(l.program.recorded_video.secondary_audio_sampling_rate?`${l.program.recorded_video.secondary_audio_sampling_rate/1e3}kHz`:"不明"),1)])],64)):V("",!0)])]),_:1})]),_:1},8,["model-value"])}}}),Bt=se(Pt,[["__scopeId","data-v-66a6f916"]]),Ct={class:"recorded-program__container"},It={class:"recorded-program__thumbnail"},St=["src"],xt={class:"recorded-program__thumbnail-duration"},Rt={key:0,class:"recorded-program__thumbnail-status recorded-program__thumbnail-status--recording"},Ht={key:1,class:"recorded-program__thumbnail-status recorded-program__thumbnail-status--analyzing"},zt={key:2,class:"recorded-program__thumbnail-status recorded-program__thumbnail-status--partial"},At={key:3,class:"recorded-program__thumbnail-progress"},Tt={class:"recorded-program__content"},Dt=["innerHTML"],Ft={class:"recorded-program__content-meta"},Nt={key:0,class:"recorded-program__content-meta-broadcaster"},Wt=["src"],Ut={class:"recorded-program__content-meta-broadcaster-name"},Et={key:1,class:"recorded-program__content-meta-broadcaster"},Ot={class:"recorded-program__content-meta-time"},jt=["innerHTML"],Yt={key:0,width:"22px",height:"22px",viewBox:"0 0 16 16"},qt={key:0,width:"22px",height:"22px",viewBox:"0 0 16 16"},Kt={key:1,width:"22px",height:"22px",viewBox:"0 0 15.2 15.2"},Gt={class:"recorded-program__menu"},Xt={class:"delete-confirmation__file-path mb-4"},Jt=ie({__name:"RecordedProgram",props:{program:{},forMylist:{type:Boolean,default:!1},forWatchedHistory:{type:Boolean,default:!1}},emits:["deleted"],setup(o,{emit:l}){const t=o,b=l,v=D(!1),_=D(!1),q=()=>{window.location.href=`${U.api_base_url}/videos/${t.program.id}/download`},s=async()=>{C.success("メタデータの再解析を開始します。完了までしばらくお待ちください。"),await oe.reanalyzeVideo(t.program.id)===!0&&C.success("メタデータの再解析が完了しました。")},p=async(r=!1)=>{C.success("サムネイルの再作成を開始しました。完了までしばらくお待ちください。"),await oe.regenerateThumbnail(t.program.id,r)===!0&&C.success("サムネイルの再作成が完了しました。")},w=_e(),y=()=>{w.settings.mylist.some(a=>a.type==="RecordedProgram"&&a.id===t.program.id)?(w.settings.mylist=w.settings.mylist.filter(a=>!(a.type==="RecordedProgram"&&a.id===t.program.id)),C.show("マイリストから削除しました。")):(w.settings.mylist.push({type:"RecordedProgram",id:t.program.id,created_at:U.time()}),C.success("マイリストに追加しました。"))},K=R(()=>w.settings.mylist.some(r=>r.type==="RecordedProgram"&&r.id===t.program.id)),k=R(()=>w.settings.watched_history.find(r=>r.video_id===t.program.id)),$=()=>{w.settings.watched_history=w.settings.watched_history.filter(r=>r.video_id!==t.program.id),C.show("視聴履歴から削除しました。")},P=()=>{const r=he();if(r.user===null||r.user.is_admin===!1){C.warning(`録画ファイルを削除するには管理者権限が必要です。
管理者アカウントでログインし直してください。`);return}_.value=!0},J=async()=>{_.value=!1,C.info("録画ファイルの削除を開始します。完了までしばらくお待ちください。"),await oe.deleteVideo(t.program.id)===!0&&(C.success("録画ファイルを削除しました。"),b("deleted",t.program.id))};return(r,a)=>{const x=te("Icon"),ae=te("router-link"),A=ye("ftooltip");return n(),m(Y,null,[S((n(),z(ae,{class:j(["recorded-program",{"recorded-program--recording":r.program.recorded_video.status==="Recording","recorded-program--analyzing":!r.program.recorded_video.has_key_frames}]),to:r.program.recorded_video.status==="Recording"||!r.program.recorded_video.has_key_frames?{path:""}:`/videos/watch/${r.program.id}`},{default:u(()=>[e("div",Ct,[e("div",It,[e("img",{class:"recorded-program__thumbnail-image",loading:"lazy",decoding:"async",src:`${I(U).api_base_url}/videos/${r.program.id}/thumbnail`},null,8,St),e("div",xt,g(I(X).getProgramDuration(r.program)),1),r.program.recorded_video.status==="Recording"?(n(),m("div",Rt,a[10]||(a[10]=[e("div",{class:"recorded-program__thumbnail-status-dot"},null,-1),M(" 録画中 ")]))):r.program.recorded_video.has_key_frames?r.program.is_partially_recorded?(n(),m("div",zt," ⚠️ 一部のみ録画 ")):V("",!0):(n(),m("div",Ht,[i(x,{icon:"fluent:clock-12-regular",width:"15px",height:"15px"}),a[11]||(a[11]=M(" メタデータ解析中 "))])),k.value?(n(),m("div",At,[e("div",{class:"recorded-program__thumbnail-progress-bar",style:fe(`width: ${k.value.last_playback_position/r.program.recorded_video.duration*100}%`)},null,4)])):V("",!0)]),e("div",Tt,[e("div",{class:"recorded-program__content-title",innerHTML:I(X).decorateProgramInfo(r.program,"title")},null,8,Dt),e("div",Ft,[r.program.channel?(n(),m("div",Nt,[e("img",{class:"recorded-program__content-meta-broadcaster-icon",loading:"lazy",decoding:"async",src:`${I(U).api_base_url}/channels/${r.program.channel.id}/logo`},null,8,Wt),e("span",Ut,"Ch: "+g(r.program.channel.channel_number)+" "+g(r.program.channel.name),1)])):(n(),m("div",Et,a[12]||(a[12]=[e("span",{class:"recorded-program__content-meta-broadcaster-name"},"チャンネル情報なし",-1)]))),e("div",Ot,g(I(X).getProgramTime(r.program)),1)]),e("div",{class:"recorded-program__content-description",innerHTML:I(X).decorateProgramInfo(r.program,"description")},null,8,jt)]),r.forWatchedHistory?V("",!0):S((n(),m("div",{key:0,class:j(["recorded-program__mylist",{"recorded-program__mylist--highlight":K.value&&!r.forMylist}]),onClick:F(y,["prevent","stop"]),onMousedown:a[0]||(a[0]=F(()=>{},["prevent","stop"]))},[r.forMylist?(n(),m("svg",Yt,a[13]||(a[13]=[e("path",{fill:"currentColor",d:"M7 3h2a1 1 0 0 0-2 0M6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0zM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5"},null,-1)]))):(n(),m(Y,{key:1},[K.value?(n(),m("svg",qt,a[14]||(a[14]=[e("path",{fill:"currentColor",d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032"},null,-1)]))):(n(),m("svg",Kt,a[15]||(a[15]=[e("path",{fill:"currentColor",d:"M8 2.5a.5.5 0 0 0-1 0V7H2.5a.5.5 0 0 0 0 1H7v4.5a.5.5 0 0 0 1 0V8h4.5a.5.5 0 0 0 0-1H8z"},null,-1)])))],64))],34)),[[O],[A,K.value?"マイリストから削除する":"マイリストに追加する"]]),r.forWatchedHistory?S((n(),m("div",{key:1,class:"recorded-program__mylist",onClick:F($,["prevent","stop"]),onMousedown:a[1]||(a[1]=F(()=>{},["prevent","stop"]))},a[16]||(a[16]=[e("svg",{width:"22px",height:"22px",viewBox:"0 0 16 16"},[e("path",{fill:"currentColor",d:"M7 3h2a1 1 0 0 0-2 0M6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0zM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5"})],-1)]),32)),[[O],[A,"視聴履歴から削除する"]]):V("",!0),e("div",Gt,[i(je,{location:"bottom end","close-on-content-click":!0},{activator:u(({props:h})=>[S((n(),m("div",E({class:"recorded-program__menu-button"},h,{onClick:a[2]||(a[2]=F(()=>{},["prevent","stop"])),onMousedown:a[3]||(a[3]=F(()=>{},["prevent","stop"]))}),a[17]||(a[17]=[e("svg",{width:"19px",height:"19px",viewBox:"0 0 16 16"},[e("path",{fill:"currentColor",d:"M9.5 13a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0"})],-1)]),16)),[[O]])]),default:u(()=>[i(Oe,{density:"compact","bg-color":"background-lighten-1",class:"recorded-program__menu-list"},{default:u(()=>[i(N,{onClick:a[4]||(a[4]=h=>v.value=!0)},{prepend:u(()=>a[18]||(a[18]=[e("svg",{width:"20px",height:"20px",viewBox:"0 0 16 16"},[e("path",{fill:"currentColor",d:"M8.499 7.5a.5.5 0 1 0-1 0v3a.5.5 0 0 0 1 0zm.25-2a.749.749 0 1 1-1.499 0a.749.749 0 0 1 1.498 0M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1M2 8a6 6 0 1 1 12 0A6 6 0 0 1 2 8"})],-1)])),default:u(()=>[i(W,{class:"ml-3"},{default:u(()=>a[19]||(a[19]=[M("録画ファイル情報を表示")])),_:1})]),_:1}),i(N,{onClick:q,disabled:r.program.recorded_video.status==="Recording"},{prepend:u(()=>[i(x,{icon:"fluent:arrow-download-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(W,{class:"ml-3"},{default:u(()=>[M("録画ファイルをダウンロード ("+g(I(U).formatBytes(r.program.recorded_video.file_size))+")",1)]),_:1})]),_:1},8,["disabled"]),S((n(),z(N,{onClick:s},{prepend:u(()=>[i(x,{icon:"fluent:book-arrow-clockwise-20-regular",width:"20px",height:"20px"})]),default:u(()=>[i(W,{class:"ml-3"},{default:u(()=>a[20]||(a[20]=[M("メタデータを再解析")])),_:1})]),_:1})),[[A,"再生時に必要な録画ファイル情報や番組情報などを解析し直します"]]),S((n(),z(N,{onClick:a[5]||(a[5]=h=>p(!0))},{prepend:u(()=>[i(x,{icon:"fluent:image-arrow-counterclockwise-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(W,{class:"ml-3"},{default:u(()=>a[21]||(a[21]=[M("サムネイルを更新")])),_:1})]),_:1})),[[A,"既存のシークバー用サムネイルから代表サムネイルを選び直します 変更反映にはブラウザキャッシュの削除が必要です"]]),S((n(),z(N,{onClick:a[6]||(a[6]=h=>p(!1))},{prepend:u(()=>[i(x,{icon:"fluent:image-arrow-counterclockwise-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(W,{class:"ml-3"},{default:u(()=>a[22]||(a[22]=[M("サムネイルを再作成")])),_:1})]),_:1})),[[A,"サムネイルを完全に作り直します（数分かかります） 変更反映にはブラウザキャッシュの削除が必要です"]]),i(qe),i(N,{onClick:P,disabled:r.program.recorded_video.status==="Recording",class:"recorded-program__menu-list-item--danger"},{prepend:u(()=>[i(x,{icon:"fluent:delete-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(W,{class:"ml-3"},{default:u(()=>a[23]||(a[23]=[M("録画ファイルを削除")])),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})])])]),_:1},8,["to","class"])),[[O]]),i(Bt,{program:r.program,show:v.value,"onUpdate:show":a[7]||(a[7]=h=>v.value=h)},null,8,["program","show"]),i(ue,{"max-width":"750",modelValue:_.value,"onUpdate:modelValue":a[9]||(a[9]=h=>_.value=h)},{default:u(()=>[i(ve,null,{default:u(()=>[i(me,{class:"d-flex justify-center pt-6 font-weight-bold"},{default:u(()=>a[24]||(a[24]=[M("本当に録画ファイルを削除しますか？")])),_:1}),i(Ue,{class:"pt-2 pb-0"},{default:u(()=>[e("div",Xt,g(r.program.recorded_video.file_path),1),a[25]||(a[25]=e("div",{class:"text-error-lighten-1 font-weight-bold"},[M(" この録画ファイルに関連するすべてのデータ (サムネイル / .ts.program.txt / .ts.err を含む) が削除されます。"),e("br"),M(" 元に戻すことはできません。本当に録画ファイルを削除しますか？ ")],-1))]),_:1}),i(Ee,{class:"pt-4 px-6 pb-6"},{default:u(()=>[i(ge),i(H,{color:"text",variant:"text",onClick:a[8]||(a[8]=h=>_.value=!1)},{default:u(()=>a[26]||(a[26]=[M("キャンセル")])),_:1}),i(H,{color:"error",variant:"flat",onClick:J},{default:u(()=>a[27]||(a[27]=[M("削除")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Qt=se(Jt,[["__scopeId","data-v-d2cb98d5"]]);function Zt(){const o=D([]);be(()=>o.value=[]);function l(t,b){o.value[b]=t}return{refs:o,updateRef:l}}const ea=ke({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:o=>o.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:o=>o%1===0},totalVisible:[Number,String],firstIcon:{type:Z,default:"$first"},prevIcon:{type:Z,default:"$prev"},nextIcon:{type:Z,default:"$next"},lastIcon:{type:Z,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Fe(),...De(),...Te(),...Ae(),...ze(),...He(),...Re({tag:"nav"}),...xe(),...Se({variant:"text"})},"VPagination"),ta=we()({name:"VPagination",props:ea(),emits:{"update:modelValue":o=>!0,first:o=>!0,prev:o=>!0,next:o=>!0,last:o=>!0},setup(o,l){let{slots:t,emit:b}=l;const v=$e(o,"modelValue"),{t:_,n:q}=Me(),{isRtl:s}=Ve(),{themeClasses:p}=Le(o),{width:w}=Pe(),y=Be(-1);le(void 0,{scoped:!0});const{resizeRef:K}=Ce(d=>{if(!d.length)return;const{target:c,contentRect:f}=d[0],L=c.querySelector(".v-pagination__list > *");if(!L)return;const B=f.width,G=L.offsetWidth+parseFloat(getComputedStyle(L).marginRight)*2;y.value=J(B,G)}),k=R(()=>parseInt(o.length,10)),$=R(()=>parseInt(o.start,10)),P=R(()=>o.totalVisible!=null?parseInt(o.totalVisible,10):y.value>=0?y.value:J(w.value,58));function J(d,c){const f=o.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((d-c*f)/c).toFixed(2))))}const r=R(()=>{if(k.value<=0||isNaN(k.value)||k.value>Number.MAX_SAFE_INTEGER)return[];if(P.value<=0)return[];if(P.value===1)return[v.value];if(k.value<=P.value)return Q(k.value,$.value);const d=P.value%2===0,c=d?P.value/2:Math.floor(P.value/2),f=d?c:c+1,L=k.value-c;if(f-v.value>=0)return[...Q(Math.max(1,P.value-1),$.value),o.ellipsis,k.value];if(v.value-L>=(d?1:0)){const B=P.value-1,G=k.value-B+$.value;return[$.value,o.ellipsis,...Q(B,G)]}else{const B=Math.max(1,P.value-2),G=B===1?v.value:v.value-Math.ceil(B/2)+$.value;return[$.value,o.ellipsis,...Q(B,G),o.ellipsis,k.value]}});function a(d,c,f){d.preventDefault(),v.value=c,f&&b(f,c)}const{refs:x,updateRef:ae}=Zt();le({VPaginationBtn:{color:T(o,"color"),border:T(o,"border"),density:T(o,"density"),size:T(o,"size"),variant:T(o,"variant"),rounded:T(o,"rounded"),elevation:T(o,"elevation")}});const A=R(()=>r.value.map((d,c)=>{const f=L=>ae(L,c);if(typeof d=="string")return{isActive:!1,key:`ellipsis-${c}`,page:d,props:{ref:f,ellipsis:!0,icon:!0,disabled:!0}};{const L=d===v.value;return{isActive:L,key:d,page:q(d),props:{ref:f,ellipsis:!1,icon:!0,disabled:!!o.disabled||Number(o.length)<2,color:L?o.activeColor:o.color,"aria-current":L,"aria-label":_(L?o.currentPageAriaLabel:o.pageAriaLabel,d),onClick:B=>a(B,d)}}}})),h=R(()=>{const d=!!o.disabled||v.value<=$.value,c=!!o.disabled||v.value>=$.value+k.value-1;return{first:o.showFirstLastPage?{icon:s.value?o.lastIcon:o.firstIcon,onClick:f=>a(f,$.value,"first"),disabled:d,"aria-label":_(o.firstAriaLabel),"aria-disabled":d}:void 0,prev:{icon:s.value?o.nextIcon:o.prevIcon,onClick:f=>a(f,v.value-1,"prev"),disabled:d,"aria-label":_(o.previousAriaLabel),"aria-disabled":d},next:{icon:s.value?o.prevIcon:o.nextIcon,onClick:f=>a(f,v.value+1,"next"),disabled:c,"aria-label":_(o.nextAriaLabel),"aria-disabled":c},last:o.showFirstLastPage?{icon:s.value?o.firstIcon:o.lastIcon,onClick:f=>a(f,$.value+k.value-1,"last"),disabled:c,"aria-label":_(o.lastAriaLabel),"aria-disabled":c}:void 0}});function re(){var c;const d=v.value-$.value;(c=x.value[d])==null||c.$el.focus()}function pe(d){d.key===de.left&&!o.disabled&&v.value>Number(o.start)?(v.value=v.value-1,ne(re)):d.key===de.right&&!o.disabled&&v.value<$.value+k.value-1&&(v.value=v.value+1,ne(re))}return Ie(()=>i(o.tag,{ref:K,class:["v-pagination",p.value,o.class],style:o.style,role:"navigation","aria-label":_(o.ariaLabel),onKeydown:pe,"data-test":"v-pagination-root"},{default:()=>[i("ul",{class:"v-pagination__list"},[o.showFirstLastPage&&i("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[t.first?t.first(h.value.first):i(H,E({_as:"VPaginationBtn"},h.value.first),null)]),i("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[t.prev?t.prev(h.value.prev):i(H,E({_as:"VPaginationBtn"},h.value.prev),null)]),A.value.map((d,c)=>i("li",{key:d.key,class:["v-pagination__item",{"v-pagination__item--is-active":d.isActive}],"data-test":"v-pagination-item"},[t.item?t.item(d):i(H,E({_as:"VPaginationBtn"},d.props),{default:()=>[d.page]})])),i("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[t.next?t.next(h.value.next):i(H,E({_as:"VPaginationBtn"},h.value.next),null)]),o.showFirstLastPage&&i("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[t.last?t.last(h.value.last):i(H,E({_as:"VPaginationBtn"},h.value.last),null)])])]})),{}}}),aa={key:0,class:"recorded-program-list__header"},oa={class:"recorded-program-list__title"},ia={class:"recorded-program-list__title-text"},sa={key:1,class:"recorded-program-list__title-count"},ra={class:"recorded-program-list__empty-content"},la=["innerHTML"],da=["innerHTML"],na={class:"recorded-program-list__grid-content"},ua={key:1,class:"recorded-program-list__pagination"},va=ie({__name:"RecordedProgramList",props:{title:{},programs:{},total:{},page:{default:1},sortOrder:{default:"desc"},hideHeader:{type:Boolean,default:!1},hideSort:{type:Boolean,default:!1},hidePagination:{type:Boolean,default:!1},showMoreButton:{type:Boolean,default:!1},showBackButton:{type:Boolean,default:!1},showEmptyMessage:{type:Boolean,default:!0},emptyIcon:{default:"fluent:warning-20-regular"},emptyMessage:{default:"録画番組が見つかりませんでした。"},emptySubMessage:{default:'サーバー設定で録画フォルダのパスを<br class="d-sm-none">正しく設定できているか確認してください。'},isLoading:{type:Boolean,default:!1},isSearching:{type:Boolean,default:!1},forMylist:{type:Boolean,default:!1},forWatchedHistory:{type:Boolean,default:!1}},emits:["update:page","update:sortOrder","more"],setup(o){We();const l=o,t=D(l.page),b=D(l.sortOrder),v=D([...l.programs]),_=D(l.total);ee(()=>l.page,s=>{t.value=s}),ee(()=>l.sortOrder,s=>{b.value=s}),ee(()=>l.programs,s=>{v.value=[...s]}),ee(()=>l.total,s=>{_.value=s});const q=s=>{v.value=v.value.filter(p=>p.id!==s),_.value--};return(s,p)=>{const w=te("Icon");return n(),m("div",{class:j(["recorded-program-list",{"recorded-program-list--show-sort":!s.hideSort}])},[s.hideHeader?V("",!0):(n(),m("div",aa,[e("h2",oa,[s.showBackButton?S((n(),m("div",{key:0,class:"recorded-program-list__title-back",onClick:p[0]||(p[0]=y=>s.$router.back())},[i(w,{icon:"fluent:chevron-left-12-filled",width:"27px"})])),[[O]]):V("",!0),e("span",ia,g(s.title),1),s.showMoreButton?V("",!0):(n(),m("div",sa,[s.isSearching?(n(),m(Y,{key:0},[i(w,{icon:"line-md:loading-twotone-loop",class:"mr-1 spin",width:"20px",height:"20px"}),p[6]||(p[6]=e("span",null,"検索中...",-1))],64)):(n(),m(Y,{key:1},[M(g(_.value)+"件",1)],64))]))]),e("div",{class:j(["recorded-program-list__actions",{"recorded-program-list__actions--mylist":s.forMylist}])},[s.hideSort?V("",!0):(n(),z(Ye,{key:0,modelValue:b.value,"onUpdate:modelValue":[p[1]||(p[1]=y=>b.value=y),p[2]||(p[2]=y=>s.$emit("update:sortOrder",y))],items:s.forMylist?[{title:"追加が新しい順",value:"mylist_added_desc"},{title:"追加が古い順",value:"mylist_added_asc"},{title:"録画が新しい順",value:"recorded_desc"},{title:"録画が古い順",value:"recorded_asc"}]:[{title:"新しい順",value:"desc"},{title:"古い順",value:"asc"}],"item-title":"title","item-value":"value",class:"recorded-program-list__sort",color:"primary","bg-color":"background-lighten-1",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue","items"])),s.showMoreButton?(n(),z(H,{key:1,variant:"text",class:"recorded-program-list__more",onClick:p[3]||(p[3]=y=>s.$emit("more"))},{default:u(()=>[p[7]||(p[7]=e("span",{class:"text-primary"},"もっと見る",-1)),i(w,{icon:"fluent:chevron-right-12-regular",width:"18px",class:"ml-1 text-text-darken-1",style:{margin:"0px -4px"}})]),_:1})):V("",!0)],2)])),e("div",{class:j(["recorded-program-list__grid",{"recorded-program-list__grid--loading":s.isLoading||s.isSearching,"recorded-program-list__grid--empty":_.value===0&&s.showEmptyMessage,"recorded-program-list__grid--searching":s.isSearching}])},[e("div",{class:j(["recorded-program-list__empty",{"recorded-program-list__empty--show":_.value===0&&s.showEmptyMessage&&!s.isSearching}])},[e("div",ra,[i(w,{class:"recorded-program-list__empty-icon",icon:s.emptyIcon,width:"54px",height:"54px"},null,8,["icon"]),e("h2",{innerHTML:s.emptyMessage},null,8,la),s.emptySubMessage?(n(),m("div",{key:0,class:"recorded-program-list__empty-submessage",innerHTML:s.emptySubMessage},null,8,da)):V("",!0)])],2),e("div",na,[(n(!0),m(Y,null,Ne(v.value,y=>(n(),z(Qt,{key:y.id,program:y,forMylist:s.forMylist,forWatchedHistory:s.forWatchedHistory,onDeleted:q},null,8,["program","forMylist","forWatchedHistory"]))),128))])],2),!s.hidePagination&&_.value>0?(n(),m("div",ua,[i(ta,{modelValue:t.value,"onUpdate:modelValue":[p[4]||(p[4]=y=>t.value=y),p[5]||(p[5]=y=>s.$emit("update:page",y))],"active-color":"primary",density:"comfortable",length:Math.ceil(_.value/30),"total-visible":7},null,8,["modelValue","length"])])):V("",!0)],2)}}}),ha=se(va,[["__scopeId","data-v-1730df4b"]]);export{ha as R};
